% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/combined_plot.R
\name{create_combined_plot}
\alias{create_combined_plot}
\title{Create Combined Sunflower and Marginal Effects Plot}
\usage{
create_combined_plot(
  plot_data,
  predictions = NULL,
  me_data = NULL,
  main_title,
  subtitle = NULL,
  caption = NULL,
  moderator = "vote_trump",
  moderator_levels = c(0, 1),
  group_labels = c("Group 0", "Group 1"),
  category_var = "category",
  category_levels = c("1", "2", "3", "4", "5"),
  category_labels = c("Strongly Disagree", "Disagree", "Neither Agree nor Disagree",
    "Agree", "Strongly Agree"),
  join_vars = c("category", "prepost"),
  focal_var = "prepost",
  focal_contrast = c(0, 1),
  color_var = "prepost",
  color_levels = c(0, 1),
  color_labels = c("Pre", "Post"),
  color_values = c("grey", "black"),
  me_y_var = "mean_effect",
  me_x_var = "category",
  me_ci_lower = NULL,
  me_ci_upper = NULL,
  sunflower_params = list(sunflower_size = 0.01, sunflower_alpha = 0.25,
    sunflower_density = 60, sunflower_aspect_ratio = 7, mean_point_size = 3,
    mean_point_alpha = 0.8, connector_linewidth = 0.5, connector_alpha = 0.5, dodge_width
    = 0.65, y_limits = c(0, 1)),
  marginal_params = list(point_size = 3, point_alpha = 0.8, connector_lines = FALSE,
    show_errorbar = TRUE, errorbar_width = 0.2, reference_line = 0, y_limits = c(-0.3,
    0.3), dodge_width = 0.6),
  layout_widths = c(0.9, 1),
  layout_heights = c(1, 1),
  save_path = NULL,
  width = 8,
  height = 6
)
}
\arguments{
\item{plot_data}{A list containing `plotting_data` and `observed_counts`}

\item{predictions}{Predictions object for calculating marginal effects (optional if me_data provided)}

\item{me_data}{Pre-calculated marginal effects data frame (optional, overrides predictions)}

\item{main_title}{Main title for the combined plot}

\item{subtitle}{Subtitle for the combined plot. Default: NULL}

\item{caption}{Caption/notes for the combined plot. Default: NULL}

\item{moderator}{Name of the moderator variable (as string). Default: "vote_trump"}

\item{moderator_levels}{Vector of two values indicating which levels to plot.
Default: c(0, 1)}

\item{group_labels}{Character vector of length 2 with labels for each group.
Default: c("Group 0", "Group 1")}

\item{category_var}{Name of the category variable. Default: "category"}

\item{category_levels}{Character vector of category levels. Default: c("1", "2", "3", "4", "5")}

\item{category_labels}{Character vector of category labels.
Default: c("Strongly Disagree", "Disagree", "Neither Agree nor Disagree", "Agree", "Strongly Agree")}

\item{join_vars}{Character vector of variable names for joining. Default: c("category", "prepost")}

\item{focal_var}{Focal variable for marginal effects. Default: "prepost"}

\item{focal_contrast}{Contrast values for focal variable. Default: c(0, 1)}

\item{color_var}{Name of variable for coloring in sunflower plots. Default: "prepost"}

\item{color_levels}{Levels of color variable. Default: c(0, 1)}

\item{color_labels}{Labels for color variable. Default: c("Pre", "Post")}

\item{color_values}{Colors for each level. Default: c("grey", "black")}

\item{me_y_var}{Name of y variable in marginal effects. Default: "mean_effect"}

\item{me_x_var}{Name of x variable in marginal effects. Default: "category"}

\item{me_ci_lower}{Name of lower CI column in marginal effects. Default: NULL (auto-detect)}

\item{me_ci_upper}{Name of upper CI column in marginal effects. Default: NULL (auto-detect)}

\item{sunflower_params}{List of parameters for sunflower plots}

\item{marginal_params}{List of parameters for marginal effect plots.
Default includes show_errorbar = TRUE to display confidence intervals}

\item{layout_widths}{Width ratios for patchwork layout. Default: c(0.9, 1)}

\item{layout_heights}{Height ratios for patchwork layout. Default: c(1, 1)}

\item{save_path}{Optional file path to save the plot}

\item{width}{Plot width for saving. Default: 8}

\item{height}{Plot height for saving. Default: 6}
}
\value{
A patchwork object with the combined plot
}
\description{
Creates a 2x2 panel plot with sunflower plots and marginal effects for two
groups defined by a moderator variable.
}
\examples{
\dontrun{
# Basic usage with Trump/Biden voters
create_combined_plot(
  plot_data = plot_burn,
  predictions = predictions_burn,
  main_title = "Support for Election Policies",
  moderator = "vote_trump",
  moderator_levels = c(0, 1),
  group_labels = c("Biden Voters", "Trump Voters"),
  join_vars = c("category", "prepost", "vote_trump")
)

# With pre-calculated marginal effects
me <- calculate_marginal_effect(predictions_burn,
                                focal_var = "prepost",
                                focal_contrast = c(0, 1),
                                moderator = "vote_trump")

create_combined_plot(
  plot_data = plot_burn,
  me_data = me,
  main_title = "Support for Election Policies"
)

# Custom sunflower parameters
create_combined_plot(
  plot_data = plot_burn,
  predictions = predictions_burn,
  sunflower_params = list(
    sunflower_size = 0.02,
    sunflower_density = 100,
    connector_linewidth = 0.8
  )
)
}

}
